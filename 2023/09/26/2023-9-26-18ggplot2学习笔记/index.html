<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.20/fancybox/fancybox.css" integrity="sha256-RvRHGSuWAxZpXKV9lLDt2e+rZ+btzn48Wp4ueS3NZKs=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"ancao96.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"BFJCK79VF9","apiKey":"613fe5e83863193288c6ef2ab02cefad","indexName":"hexo","hits":{"per_page":10}}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文由SCY原创，转载注明出处。  本文主要讲解ggplot2包的绘图原理及案例。">
<meta property="og:type" content="article">
<meta property="og:title" content="(18)ggplot2学习笔记">
<meta property="og:url" content="https://ancao96.github.io/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="SCY SPACE">
<meta property="og:description" content="本文由SCY原创，转载注明出处。  本文主要讲解ggplot2包的绘图原理及案例。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261851515.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261851934.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261852294.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261854741.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261854908.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261855700.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261855073.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261856971.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261857125.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261857128.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261857229.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261858077.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261858073.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261859020.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261859435.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261900723.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261900283.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261901326.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261902563.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261902488.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261902591.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261903930.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261904849.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261904137.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261908826.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261909630.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261909617.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261910149.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261910651.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261911820.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261911120.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261912943.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261913793.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261913951.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261914276.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261914917.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261915374.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261915969.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261916533.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261917355.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261917648.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261917263.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261918156.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261918879.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261919619.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261919424.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261920586.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261920711.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261920810.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261921706.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261921219.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261922958.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261922601.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261923599.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261923530.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261924829.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261925369.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261925448.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261926053.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261926883.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261927264.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261928986.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261928876.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261929606.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261929736.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261929446.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261930664.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261930516.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261931872.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261931212.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261932217.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261932191.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261932851.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261933411.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261933924.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261934468.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261934419.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261934700.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261935573.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261936260.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261936622.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261937879.png">
<meta property="og:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261937033.png">
<meta property="article:published_time" content="2023-09-26T10:44:20.000Z">
<meta property="article:modified_time" content="2023-10-04T05:18:32.213Z">
<meta property="article:author" content="SCY">
<meta property="article:tag" content="R">
<meta property="article:tag" content="ggplot2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261851515.png">


<link rel="canonical" href="https://ancao96.github.io/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://ancao96.github.io/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","path":"2023/09/26/2023-9-26-18ggplot2学习笔记/","title":"(18)ggplot2学习笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>(18)ggplot2学习笔记 | SCY SPACE</title>
    







<link rel="dns-prefetch" href="https://waline-server-nxpj3ksyo-scy.vercel.app">
    <noscript>
      <link rel="stylesheet" href="/css/noscript.css">
    </noscript>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.0.0/style.css">
    <style>
      body,div.post-body,h1,h2,h3,h4 {
        font-family: "LXGW WenKai LITE", sans-serif;
        font-size: 108%;
      }
    </style>
  </head>
  <body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
    <div class="headband"></div>
    <main class="main">
      <div class="column">
        <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">SCY SPACE</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">10</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">10</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">22</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

    </div>
  </div>

</header>
          
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="nav-number">1.</span> <span class="nav-text"> ggplot2学习笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.</span> <span class="nav-text"> 原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E6%A8%A1%E7%89%88"><span class="nav-number">1.1.1.</span> <span class="nav-text"> 语法模版</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%98%A0%E5%B0%84"><span class="nav-number">1.2.</span> <span class="nav-text"> 映射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E9%87%8F%E5%92%8C%E6%B2%B9%E8%80%97%E4%B9%8B%E9%97%B4%E6%98%AF%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB"><span class="nav-number">1.2.1.</span> <span class="nav-text"> 排量和油耗之间是什么关系？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%A0%E5%B0%84-vs-%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.2.2.</span> <span class="nav-text"> 映射 VS 设置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%A0%E4%BD%95%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.3.</span> <span class="nav-text"> 几何对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-vs-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="nav-number">1.3.1.</span> <span class="nav-text"> 全局变量 VS 局部变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E5%9B%BE%E8%A1%A8"><span class="nav-number">1.4.</span> <span class="nav-text"> 保存图表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%A7%E7%BB%AD%E8%BF%9B%E9%98%B6%E7%89%88%E6%9C%AC%E7%9A%84%E6%95%99%E7%A8%8B"><span class="nav-number">1.5.</span> <span class="nav-text"> 继续进阶版本的教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%B1%E7%8A%B6%E5%9B%BE"><span class="nav-number">1.5.1.</span> <span class="nav-text"> 柱状图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E6%96%B9%E5%9B%BE"><span class="nav-number">1.5.2.</span> <span class="nav-text"> 直方图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%B1%E7%BA%BF%E5%9B%BE"><span class="nav-number">1.5.3.</span> <span class="nav-text"> 箱线图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E6%8F%90%E7%90%B4%E5%9B%BE"><span class="nav-number">1.5.4.</span> <span class="nav-text"> 小提琴图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%96%E6%95%A3%E5%9B%BE"><span class="nav-number">1.5.5.</span> <span class="nav-text"> 抖散图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%B1%E5%B3%A6%E5%9B%BE"><span class="nav-number">1.5.6.</span> <span class="nav-text"> 山峦图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="nav-number">1.5.7.</span> <span class="nav-text"> 散点图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.6.</span> <span class="nav-text"> 主题设置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#theme%E5%8E%9F%E7%90%86"><span class="nav-number">1.6.1.</span> <span class="nav-text"> theme原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E5%85%83%E7%B4%A0"><span class="nav-number">1.6.2.</span> <span class="nav-text"> 整体元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9D%90%E6%A0%87%E8%BD%B4%E5%85%83%E7%B4%A0"><span class="nav-number">1.6.3.</span> <span class="nav-text"> 坐标轴元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%A2%E6%9D%BF%E5%85%83%E7%B4%A0"><span class="nav-number">1.6.4.</span> <span class="nav-text"> 面板元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E4%BE%8B%E5%85%83%E7%B4%A0"><span class="nav-number">1.6.5.</span> <span class="nav-text"> 图例元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E9%9D%A2%E5%85%83%E7%B4%A0"><span class="nav-number">1.6.6.</span> <span class="nav-text"> 分面元素</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E5%BA%A6"><span class="nav-number">1.7.</span> <span class="nav-text"> 标度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9D%90%E6%A0%87%E8%BD%B4"><span class="nav-number">1.7.1.</span> <span class="nav-text"> 坐标轴</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%9C%E8%89%B2"><span class="nav-number">1.7.2.</span> <span class="nav-text"> 颜色</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%99%E7%A8%8B%E4%B8%80"><span class="nav-number">1.8.</span> <span class="nav-text"> 教程（一）</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SCY" src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">SCY</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/AnCao96" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AnCao96" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ancao.cugb@gmail.com" title="E-Mail → mailto:ancao.cugb@gmail.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


      </div>
      <div class="main-inner post posts-expand">


  


<div class="post-block">
    
    

    <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
        <link itemprop="mainEntityOfPage" href="https://ancao96.github.io/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

        <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
            <meta itemprop="image" content="/images/avatar.gif">
            <meta itemprop="name" content="SCY">
        </span>

        <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
            <meta itemprop="name" content="SCY SPACE">
            <meta itemprop="description" content>
        </span>

        <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
            <meta itemprop="name" content="(18)ggplot2学习笔记 | SCY SPACE">
            <meta itemprop="description" content>
        </span>
        <header class="post-header">
            <h1 class="post-title" itemprop="name headline">
                (18)ggplot2学习笔记
            </h1>

            <div class="post-meta-container">
                <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-26 18:44:20" itemprop="dateCreated datePublished" datetime="2023-09-26T18:44:20+08:00">2023-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-10-04 13:18:32" itemprop="dateModified" datetime="2023-10-04T13:18:32+08:00">2023-10-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/R/ggplot2/" itemprop="url" rel="index"><span itemprop="name">ggplot2</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>22 分钟</span>
    </span>
</div>

            </div>
        </header>

        
        
        
        <div class="post-body" itemprop="articleBody"><blockquote><p>本文由SCY原创，转载注明出处。</p>
</blockquote>
<p>本文主要讲解ggplot2包的绘图原理及案例。</p>
<span id="more"></span>
<h1 id="ggplot2学习笔记"><a class="markdownIt-Anchor" href="#ggplot2学习笔记"></a> ggplot2学习笔记</h1>
<p>ggplot2是基于图层图形语法（the Grammar of Graphics），可简单粗暴的理解为，先绘制好图形的每一部分，然后将各部分相加形成一张完善的图形，使用ggplot2时，会反复使用如下几个对象，简单介绍：</p>
<ol>
<li><strong>几何对象</strong>（<strong>geom</strong>） geometric objects，如散点points、<br>
线性lines、柱状bars及方图Histogram等，可绘制的geom为：</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<ol>
<li>
<p><strong>标度</strong>（<strong>scale</strong>） scales map values in the data space to values in the aesthetic space. This includes the use of colour, shape or size. Scales also draw the legend and axes, which make it possible to read the original data values from the plot（<strong>将数据取值映射到图形</strong>空间，使用颜色，形状，大小表示不同取值，使用图例，网格线展示标度）</p>
</li>
<li>
<p><strong>图像属性</strong>（aes）data to the <strong>aes</strong>thetic attributes (color, shape, size)</p>
</li>
<li>
<p><strong>坐标系</strong>（<strong>coord</strong>）information about the plot’s <strong>coord</strong>inate system（描述数据如何映射到图形，同时包含坐标轴和网格线 axes, gridlines）</p>
</li>
<li>
<p><strong>统计变换</strong>（<strong>stat</strong>）<strong>stat</strong>istical transformations of the data，对数据的汇总</p>
</li>
<li>
<p><strong>分面</strong>（<strong>facet</strong>） A facet specifies how to break up and display subsets of data as small multiples. This is also known as conditioning or latticing/trellising.（将数据拆分为子集，对各子集作图并联合展示，也成条件作图或网格图）</p>
</li>
<li>
<p><strong>绘图主题</strong>（<strong>theme</strong>）A<strong>theme</strong>controls the finer points of display, like the font size and background colour. While the defaults in ggplot2 have been chosen with care, you may need to consult other references to create an attractive plot.（主题涉及图形更细的方面，如背景色，字体大小等）。</p>
</li>
</ol>
<h2 id="原理"><a class="markdownIt-Anchor" href="#原理"></a> 原理</h2>
<p><code>ggplot()</code>函数包括9个部件：</p>
<ul>
<li><strong>数据（data）</strong></li>
<li><strong>映射（mapping）</strong></li>
<li><strong>几何对象（geom）</strong></li>
<li>统计变换（stats）</li>
<li>标度（scale）</li>
<li>坐标系（coord）</li>
<li>分面（facet）</li>
<li>主题（theme）</li>
<li>存储和输出（output）</li>
</ul>
<p>其中前三个是必需的。</p>
<p>Hadley wickham将这套语法诠释为：一张统计图形就是从<strong>数据</strong>到<strong>几何对象</strong> (geometric object，缩写<strong>geom</strong>)的<strong>图形属性</strong>(aesthetic attribute，缩写<strong>aes</strong>)的一个映射。</p>
<p>此外，图形中还可能包合数据的统计变换（statistical transformation，缩写stat），最后绘制在某个特定的坐标系（coordinate system，缩写coord）中，而分面（facet）则可以用来生成数据不同子集的图形。</p>
<h3 id="语法模版"><a class="markdownIt-Anchor" href="#语法模版"></a> 语法模版</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>colorspace<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">d <span class="operator">&lt;-</span> read_csv<span class="punctuation">(</span><span class="string">&quot;data/temp_carbon.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> d<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> year<span class="punctuation">,</span> y <span class="operator">=</span> carbon_emissions<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;year&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylab<span class="punctuation">(</span><span class="string">&quot;carbon emissions (metric tons)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Annual global carbon emissions, 1880-2014&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261851515.png" alt></p>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261851934.png" alt></p>
<h2 id="映射"><a class="markdownIt-Anchor" href="#映射"></a> 映射</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mpg</span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 234 × 11
#&gt;    manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
#&gt;    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt;  1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…
#&gt;  2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…
#&gt;  3 audi         a4           2    2008     4 manu… f        20    31 p     comp…
#&gt;  4 audi         a4           2    2008     4 auto… f        21    30 p     comp…
#&gt;  5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…
#&gt;  6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…
#&gt;  7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…
#&gt;  8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…
#&gt;  9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…
#&gt; 10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…
#&gt; # ℹ 224 more rows
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str<span class="punctuation">(</span>mpg<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; tibble [234 × 11] (S3: tbl_df/tbl/data.frame)
#&gt;  $ manufacturer: chr [1:234] &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ...
#&gt;  $ model       : chr [1:234] &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ...
#&gt;  $ displ       : num [1:234] 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
#&gt;  $ year        : int [1:234] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
#&gt;  $ cyl         : int [1:234] 4 4 4 4 6 6 6 4 4 4 ...
#&gt;  $ trans       : chr [1:234] &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ...
#&gt;  $ drv         : chr [1:234] &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ...
#&gt;  $ cty         : int [1:234] 18 21 20 21 16 18 18 18 16 20 ...
#&gt;  $ hwy         : int [1:234] 29 29 31 30 26 26 27 26 25 28 ...
#&gt;  $ fl          : chr [1:234] &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ...
#&gt;  $ class       : chr [1:234] &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ...
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">序号</th>
<th style="text-align:left">变量</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">manufacturer</td>
<td style="text-align:left">生产厂家</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">model</td>
<td style="text-align:left">类型</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">displ</td>
<td style="text-align:left">发动机排量（升）</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">year</td>
<td style="text-align:left">生产年份</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">cyl</td>
<td style="text-align:left">气缸数量</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">trans</td>
<td style="text-align:left">传输类型</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left">drv</td>
<td style="text-align:left">驱动类型（f =前轮驱动，r=后轮驱动，4= 4wd）</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:left">cty</td>
<td style="text-align:left">每加仑城市里程</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:left">hwy</td>
<td style="text-align:left">每加仑高速公路英里</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:left">fl</td>
<td style="text-align:left">汽油种类</td>
</tr>
<tr>
<td style="text-align:left">11</td>
<td style="text-align:left">class</td>
<td style="text-align:left">类型</td>
</tr>
</tbody>
</table>
<h3 id="排量和油耗之间是什么关系"><a class="markdownIt-Anchor" href="#排量和油耗之间是什么关系"></a> 排量和油耗之间是什么关系？</h3>
<p>提取子集：<code>displ</code> <code>hwy</code> <code>class</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mpg <span class="operator">%&gt;%</span> </span><br><span class="line">  select<span class="punctuation">(</span>displ<span class="punctuation">,</span> hwy<span class="punctuation">,</span> <span class="built_in">class</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 234 × 3
#&gt;    displ   hwy class  
#&gt;    &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  
#&gt;  1   1.8    29 compact
#&gt;  2   1.8    29 compact
#&gt;  3   2      31 compact
#&gt;  4   2      30 compact
#&gt;  5   2.8    26 compact
#&gt;  6   2.8    26 compact
#&gt;  7   3.1    27 compact
#&gt;  8   1.8    26 compact
#&gt;  9   1.8    25 compact
#&gt; 10   2      28 compact
#&gt; # ℹ 224 more rows
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261852294.png" alt></p>
<ul>
<li>
<p><code>ggplot()</code>表示调用该函数画图，<code>data = mpg</code>表示使用mpg这个<strong>数据框</strong>来画图。</p>
</li>
<li>
<p><code>aes()</code>表示数据和视觉属性之间的映射，<code>aes(x = displ, y = hwy)</code>，意思是变量<code>displ</code>作为（映射为）x轴方向的<strong>位置</strong>，变量<code>hwy</code>作为（映射为）y轴方向的<strong>位置</strong>。</p>
</li>
<li>
<p><code>aes()</code>除了位置上映射，还可以实现色彩、形状或透明度等视觉属性的映射。</p>
</li>
<li>
<p><code>geom_point()</code>表示绘制散点图。</p>
</li>
<li>
<p><code>+</code> 表示添加图层。</p>
</li>
</ul>
<p>以上是位置上的映射，ggplot还包含了颜色、形状以及透明度等图形属性的映射，比如在<code>aes()</code>增加一个’color = class`，具体来说，<strong>不同的汽车类型</strong>，用<strong>不同的颜色</strong>来表现。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261854741.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> size <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261854908.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> shape <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261855700.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261855073.png" alt></p>
<h3 id="映射-vs-设置"><a class="markdownIt-Anchor" href="#映射-vs-设置"></a> 映射 VS 设置</h3>
<p>点指定为某一颜色</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> pa</span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> pb</span><br><span class="line">pa <span class="operator">/</span> pb</span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261856971.png" alt></p>
<p>pa和pb的区别：pa中的”blue”一个固定值也是唯一值映射给了color；pb颜色设置为”blue”蓝色</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261857125.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>shape<span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261857128.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261857229.png" alt></p>
<h2 id="几何对象"><a class="markdownIt-Anchor" href="#几何对象"></a> 几何对象</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span>  <span class="operator">-&gt;</span> p1</span><br><span class="line">p1</span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261858077.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> p2</span><br><span class="line">p2</span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261858073.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> p3</span><br><span class="line">p3</span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261859020.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>p1 <span class="operator">/</span> p2<span class="punctuation">)</span> <span class="operator">|</span> p3 </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261859435.png" alt></p>
<h3 id="全局变量-vs-局部变量"><a class="markdownIt-Anchor" href="#全局变量-vs-局部变量"></a> 全局变量 VS 局部变量</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261900723.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261900283.png" alt></p>
<p>事实上，如果映射关系<code>aes()</code>写在<code>ggplot()</code>里，就是全局变量；如果写在<code>geom_xxx()</code>里就是局部变量。</p>
<p>缺少局部变量的映射关系时，就会到全局变量寻找。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261901326.png" alt></p>
<p>上图中<code>geom_point()</code>和<code>geom_smooth()</code>缺少局部变量的映射关系，就会继承全局变量的映射关系。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261902563.png" alt></p>
<p><code>geom_smooth()</code>缺少局部变量的映射关系，要继承全局变量映射关系，但是全局变量没有指定特别的映射关系，因此只画一条拟合曲线。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mpg<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261902488.png" alt></p>
<p><code>geom_point()</code>中有因子型的局部变量<code>cyl</code>，因此不再继承全局变量。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>displ<span class="punctuation">,</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261902591.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>displ<span class="punctuation">,</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261903930.png" alt></p>
<h2 id="保存图表"><a class="markdownIt-Anchor" href="#保存图表"></a> 保存图表</h2>
<p>使用<code>ggsave()</code>函数把图表保存为<code>.png</code>或者<code>.pdf</code>。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>displ<span class="punctuation">,</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;This is my first plot&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> p</span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;first.pdf&quot;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> dpi <span class="operator">=</span> <span class="number">300</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h2 id="继续进阶版本的教程"><a class="markdownIt-Anchor" href="#继续进阶版本的教程"></a> 继续进阶版本的教程</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>gghighlight<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>cowplot<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggforce<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">read_csv<span class="punctuation">(</span><span class="string">&quot;data/datasaurus.csv&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df</span><br><span class="line"></span><br><span class="line">df <span class="operator">%&gt;%</span> </span><br><span class="line">  count<span class="punctuation">(</span>dataset<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 13 × 2
#&gt;    dataset        n
#&gt;    &lt;chr&gt;      &lt;int&gt;
#&gt;  1 away         142
#&gt;  2 bullseye     142
#&gt;  3 circle       142
#&gt;  4 dino         142
#&gt;  5 dots         142
#&gt;  6 h_lines      142
#&gt;  7 high_lines   142
#&gt;  8 slant_down   142
#&gt;  9 slant_up     142
#&gt; 10 star         142
#&gt; 11 v_lines      142
#&gt; 12 wide_lines   142
#&gt; 13 x_shape      142
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>dataset<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  summarise<span class="punctuation">(</span></span><br><span class="line">    across<span class="punctuation">(</span>everything<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">list</span><span class="punctuation">(</span>mean <span class="operator">=</span> mean<span class="punctuation">,</span> sd <span class="operator">=</span>sd<span class="punctuation">)</span><span class="punctuation">,</span> .names <span class="operator">=</span> <span class="string">&quot;&#123;fn&#125;_&#123;col&#125;&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span></span><br><span class="line">    across<span class="punctuation">(</span><span class="built_in">is.numeric</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 13 × 5
#&gt;    dataset    mean_x  sd_x mean_y  sd_y
#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 away         54.3  16.8   47.8  26.9
#&gt;  2 bullseye     54.3  16.8   47.8  26.9
#&gt;  3 circle       54.3  16.8   47.8  26.9
#&gt;  4 dino         54.3  16.8   47.8  26.9
#&gt;  5 dots         54.3  16.8   47.8  26.9
#&gt;  6 h_lines      54.3  16.8   47.8  26.9
#&gt;  7 high_lines   54.3  16.8   47.8  26.9
#&gt;  8 slant_down   54.3  16.8   47.8  26.9
#&gt;  9 slant_up     54.3  16.8   47.8  26.9
#&gt; 10 star         54.3  16.8   47.8  26.9
#&gt; 11 v_lines      54.3  16.8   47.8  26.9
#&gt; 12 wide_lines   54.3  16.8   47.8  26.9
#&gt; 13 x_shape      54.3  16.8   47.8  26.9
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> color <span class="operator">=</span> dataset<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>dataset<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261904849.png" alt></p>
<p>事实上，每张图都相差很大。所以，要眼见为实。换句话说，可视化是数据探索中非常重要的部分。</p>
<p>前面讲到R语言数据类型有字符串型、数值型、因子型、逻辑型、日期型等，ggplot2会将字符串型、因子型、逻辑型、日期型默认为<strong>离散变量</strong>，而数值型默认为<strong>连续变量</strong>。在呈现现数据的时候，可能会同时用到多种类型的数据，比如</p>
<ul>
<li>
<p>一个离散</p>
</li>
<li>
<p>一个连续</p>
</li>
<li>
<p>两个离散</p>
</li>
<li>
<p>两个连续</p>
</li>
<li>
<p>一个离散，一个连续</p>
</li>
<li>
<p>三个连续</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">read_csv<span class="punctuation">(</span><span class="string">&quot;data/gapminder.csv&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> gapdata</span><br><span class="line">gapdata</span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 1,704 × 6
#&gt;    country     continent  year lifeExp      pop gdpPercap
#&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.
#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.
#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.
#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.
#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.
#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.
#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.
#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.
#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.
#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.
#&gt; # ℹ 1,694 more rows
</code></pre>
<p>检查是否存在缺失值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  summarise<span class="punctuation">(</span></span><br><span class="line">    across<span class="punctuation">(</span>everything<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="operator">~</span> <span class="built_in">sum</span><span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>.<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 1 × 6
#&gt;   country continent  year lifeExp   pop gdpPercap
#&gt;     &lt;int&gt;     &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt;     &lt;int&gt;
#&gt; 1       0         0     0       0     0         0
</code></pre>
<p>选择什么样的类型呈现数据</p>
<h3 id="柱状图"><a class="markdownIt-Anchor" href="#柱状图"></a> 柱状图</h3>
<p>常用于一个离散变量</p>
<p><code>geom_bar()</code>自动完成了统计工作<code>stat_count()</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> gapdata<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line"> geom_bar<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261904137.png" alt></p>
<p>x轴变量排序利用<code>reorder()</code>函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> gapdata<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> reorder<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">,</span> continent<span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261908826.png" alt></p>
<p>x轴和y轴翻转</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> gapdata<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> reorder<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">,</span> continent<span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261909630.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  distinct<span class="punctuation">(</span>continent<span class="punctuation">,</span> country<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261909617.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># distinct()函数保持数据唯一行，去除重复的行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先做计算在画图</span></span><br><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  distinct<span class="punctuation">(</span>continent<span class="punctuation">,</span> country<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>continent<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  summarise<span class="punctuation">(</span>n <span class="operator">=</span> n<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">,</span> y <span class="operator">=</span> n<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261910149.png" alt></p>
<h3 id="直方图"><a class="markdownIt-Anchor" href="#直方图"></a> 直方图</h3>
<p>连续变量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>binwidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261910651.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># binwidth 代表条的宽度</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span> x<span class="operator">=</span> lifeExp<span class="punctuation">,</span> color <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_freqpoly<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261911820.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># smooth histogram = density plot</span></span><br><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span> lifeExp<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>continent<span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261911120.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span>adjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261912943.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span>adjust <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261913793.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261913951.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span>aes<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261914276.png" alt></p>
<p>在**<code>ggplot2</code>**中，图形是由数据、几何对象（geoms）和美学映射（aesthetic mappings）组成的。这些元素合在一起定义了你的图形长什么样和代表了什么。</p>
<p><strong><code>aes()</code><strong>函数是用于定义美学映射的。简单来说，当你想基于数据的某个变量来决定一个图形特性（如颜色、大小、形状等）时，你就会用到</strong><code>aes()</code><strong>函数。当你把一个变量放到</strong><code>aes()</code><strong>里，你实际上是告诉</strong><code>ggplot</code></strong>：“请根据这个变量的值来改变某个图形特性”。</p>
<p>例如，<strong><code>aes(x = lifeExp, fill = continent)</code><strong>告诉</strong><code>ggplot</code></strong>，x坐标应该由**<code>lifeExp</code><strong>决定，并且填充颜色应该基于</strong><code>continent</code>**的不同类别来变化。</p>
<p>当你在**<code>geom_density(alpha = 0.3)</code><strong>这样的设置中直接为<code>alpha</code>赋值，你是在给这个特性一个固定的值。这就意味着，不论数据如何，<code>图形的这个特性都是这个固定值</code>。而当你使用</strong><code>geom_density(aes(alpha = 0.3))</code><strong>，你实际上是在告诉<code>ggplot</code>，你希望</strong>透明度基于某种数据来变化**。但因为你给了它一个固定的数字，它实际上并没有根据数据变化。这是一个容易引起混淆的写法，因为通常我们希望在**<code>aes()</code>内部映射的都是数据集中的变量，而不是固定值**。</p>
<p>为什么第一种方法更好：使用<code>aes()</code>来映射数据到图形的某个特性时，应该确保<strong>映射的真的是数据集中的某个变量</strong>。<strong>把固定的属性值放到<code>aes()</code>内部是不清晰的</strong>，因为这种写法会让读者误以为这个特性是根据数据变化的。为了代码的清晰和明确，最好避免这种混淆。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>continent <span class="operator">!=</span> <span class="string">&quot;Oceania&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_grid<span class="punctuation">(</span>continent<span class="operator">~</span>.<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261914917.png" alt></p>
<p>直方图和密度图画在一起。注意<code>y = stat(density)</code>表示y是由x新生成的变量，这是一种固定写法，类似的还有<code>stat(count)</code>和<code>stat(level)</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>continent <span class="operator">!=</span> <span class="string">&quot;Oceania&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> y <span class="operator">=</span> stat<span class="punctuation">(</span>density<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_grid<span class="punctuation">(</span>continent<span class="operator">~</span>.<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261915374.png" alt></p>
<h3 id="箱线图"><a class="markdownIt-Anchor" href="#箱线图"></a> 箱线图</h3>
<p>一个离散型一个连续型</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># year原本为数值型，先用factor函数将数值型转化为离散型</span></span><br><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> factor<span class="punctuation">(</span>year<span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261915969.png" alt></p>
<h3 id="小提琴图"><a class="markdownIt-Anchor" href="#小提琴图"></a> 小提琴图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> year<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_violin<span class="punctuation">(</span>aes<span class="punctuation">(</span>group <span class="operator">=</span> year<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_jitter<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>se <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261916533.png" alt></p>
<h3 id="抖散图"><a class="markdownIt-Anchor" href="#抖散图"></a> 抖散图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_jitter<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261917355.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_jitter<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_summary<span class="punctuation">(</span>fun.y <span class="operator">=</span> median<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> geom <span class="operator">=</span> <span class="string">&quot;point&quot;</span><span class="punctuation">,</span> szie <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261917648.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> continent<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_violin<span class="punctuation">(</span></span><br><span class="line">    trim <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">    alpha <span class="operator">=</span> <span class="number">0.5</span></span><br><span class="line">    <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_summary<span class="punctuation">(</span></span><br><span class="line">    fun.y <span class="operator">=</span> mean<span class="punctuation">,</span></span><br><span class="line">    fun.max <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">      mean<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">+</span> sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    fun.min <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">      mean<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">-</span> sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    geom <span class="operator">=</span> <span class="string">&quot;pointrange&quot;</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261917263.png" alt></p>
<h3 id="山峦图"><a class="markdownIt-Anchor" href="#山峦图"></a> 山峦图</h3>
<p>一个连续变量一个离散变量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> y <span class="operator">=</span> continent<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggridges<span class="operator">::</span>geom_density_ridges<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261918156.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> y <span class="operator">=</span> continent<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggridges<span class="operator">::</span>geom_density_ridges<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span></span><br><span class="line">    values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#003f5c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#58508d&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#bc5090&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#ff6361&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#ffa600&quot;</span><span class="punctuation">)</span></span><br><span class="line">      <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261918879.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> lifeExp<span class="punctuation">,</span> y <span class="operator">=</span> continent<span class="punctuation">,</span> fill <span class="operator">=</span> continent<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggridges<span class="operator">::</span>geom_density_ridges<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span></span><br><span class="line">    values <span class="operator">=</span> colorspace<span class="operator">::</span>sequential_hcl<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> palette <span class="operator">=</span> <span class="string">&quot;Peach&quot;</span><span class="punctuation">)</span></span><br><span class="line">      <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261919619.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增加标度 更换填充的颜色</span></span><br></pre></td></tr></table></figure>
<h3 id="散点图"><a class="markdownIt-Anchor" href="#散点图"></a> 散点图</h3>
<p>两个连续变量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261919424.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">log</span><span class="punctuation">(</span>gdpPercap<span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> <span class="string">&quot;lm&quot;</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261920586.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_x_log10<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261920711.png" alt></p>
<h2 id="主题设置"><a class="markdownIt-Anchor" href="#主题设置"></a> 主题设置</h2>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261920810.png" alt></p>
<h3 id="theme原理"><a class="markdownIt-Anchor" href="#theme原理"></a> theme原理</h3>
<p><code>element_function()</code>包括四个：</p>
<ul>
<li>
<p><code>element_text()</code> # 文本，控制标签和标题的字体</p>
</li>
<li>
<p><code>element_line()</code> # 线条，控制线条的颜色、类型、粗细</p>
</li>
<li>
<p><code>element_rect()</code> # 矩形，控制背景矩形的颜色或边界线条类型</p>
</li>
<li>
<p><code>element_blank()</code> # 空白，不分配绘图空间，删去该区域绘图元素</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glimpse<span class="punctuation">(</span>mpg<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; Rows: 234
#&gt; Columns: 11
#&gt; $ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;…
#&gt; $ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;, &quot;…
#&gt; $ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0, 2.…
#&gt; $ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, 200…
#&gt; $ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, 8, …
#&gt; $ trans        &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;auto…
#&gt; $ drv          &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4…
#&gt; $ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17, 1…
#&gt; $ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25, 2…
#&gt; $ fl           &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p…
#&gt; $ class        &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;c…
</code></pre>
<p>整理数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mpg <span class="operator">%&gt;%</span> </span><br><span class="line">  filter<span class="punctuation">(</span><span class="built_in">class</span> <span class="operator">!=</span> <span class="string">&quot;2seater&quot;</span><span class="punctuation">,</span> manufacturer <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;toyota&quot;</span><span class="punctuation">,</span> <span class="string">&quot;volkswagen&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 61 × 11
#&gt;    manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
#&gt;    &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt;  1 toyota       4runner 4…   2.7  1999     4 manu… 4        15    20 r     suv  
#&gt;  2 toyota       4runner 4…   2.7  1999     4 auto… 4        16    20 r     suv  
#&gt;  3 toyota       4runner 4…   3.4  1999     6 auto… 4        15    19 r     suv  
#&gt;  4 toyota       4runner 4…   3.4  1999     6 manu… 4        15    17 r     suv  
#&gt;  5 toyota       4runner 4…   4    2008     6 auto… 4        16    20 r     suv  
#&gt;  6 toyota       4runner 4…   4.7  2008     8 auto… 4        14    17 r     suv  
#&gt;  7 toyota       camry        2.2  1999     4 manu… f        21    29 r     mids…
#&gt;  8 toyota       camry        2.2  1999     4 auto… f        21    27 r     mids…
#&gt;  9 toyota       camry        2.4  2008     4 manu… f        21    31 r     mids…
#&gt; 10 toyota       camry        2.4  2008     4 auto… f        21    31 r     mids…
#&gt; # ℹ 51 more rows
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span></span><br><span class="line">ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span>y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_grid<span class="punctuation">(</span>vars<span class="punctuation">(</span>manufacturer<span class="punctuation">)</span><span class="punctuation">,</span> vars<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">ggtitle<span class="punctuation">(</span><span class="string">&quot;这是我的标题&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x_displ&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;y_hwy&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261921706.png" alt></p>
<p>修改主题</p>
<h3 id="整体元素"><a class="markdownIt-Anchor" href="#整体元素"></a> 整体元素</h3>
<table>
<thead>
<tr>
<th>描述</th>
<th>主题元素</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>整个图形背景（plot）</td>
<td><code>plot.background</code></td>
<td><code>element_rect()</code></td>
</tr>
<tr>
<td>图形标题</td>
<td><code>plot.title</code></td>
<td><code>element_text()</code></td>
</tr>
<tr>
<td>图形边距</td>
<td><code>plot.margin</code></td>
<td><code>margin()</code></td>
</tr>
</tbody>
</table>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span></span><br><span class="line">ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span>y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_grid<span class="punctuation">(</span>vars<span class="punctuation">(</span>manufacturer<span class="punctuation">)</span><span class="punctuation">,</span> vars<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">ggtitle<span class="punctuation">(</span><span class="string">&quot;这是我的标题&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x_displ&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;y_hwy&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> r <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> b <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> l <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> unit <span class="operator">=</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261921219.png" alt></p>
<h3 id="坐标轴元素"><a class="markdownIt-Anchor" href="#坐标轴元素"></a> 坐标轴元素</h3>
<table>
<thead>
<tr>
<th>描述</th>
<th>主题元素</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>坐标轴刻度</td>
<td><code>axis.ticks</code></td>
<td><code>element_line()</code></td>
</tr>
<tr>
<td>坐标轴标题</td>
<td><code>axis.title</code></td>
<td><code>element_text()</code></td>
</tr>
<tr>
<td>坐标轴标签</td>
<td><code>axis.text</code></td>
<td><code>element_text()</code></td>
</tr>
<tr>
<td>直线和坐标轴</td>
<td><code>axis.line</code></td>
<td><code>element_line()</code></td>
</tr>
</tbody>
</table>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span></span><br><span class="line">ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span>y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_grid<span class="punctuation">(</span>vars<span class="punctuation">(</span>manufacturer<span class="punctuation">)</span><span class="punctuation">,</span> vars<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">ggtitle<span class="punctuation">(</span><span class="string">&quot;这是我的标题&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x_displ&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;y_hwy&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;purple&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261922958.png" alt></p>
<h3 id="面板元素"><a class="markdownIt-Anchor" href="#面板元素"></a> 面板元素</h3>
<table>
<thead>
<tr>
<th>描述</th>
<th>主题元素</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>面板背景</td>
<td><code>panel.background</code></td>
<td><code>element_rect()</code></td>
</tr>
<tr>
<td>面板网格线</td>
<td><code>panel.grid</code></td>
<td><code>element_line()</code></td>
</tr>
<tr>
<td>面板边界</td>
<td><code>panel.border</code></td>
<td><code>element_rect()</code></td>
</tr>
</tbody>
</table>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span></span><br><span class="line">ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span>y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_grid<span class="punctuation">(</span>vars<span class="punctuation">(</span>manufacturer<span class="punctuation">)</span><span class="punctuation">,</span> vars<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">ggtitle<span class="punctuation">(</span><span class="string">&quot;这是我的标题&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x_displ&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;y_hwy&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;purple&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.grid <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;grey80&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261922601.png" alt></p>
<h3 id="图例元素"><a class="markdownIt-Anchor" href="#图例元素"></a> 图例元素</h3>
<table>
<thead>
<tr>
<th>描述</th>
<th>主题元素</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>图例背景</td>
<td><code>legend. background</code></td>
<td><code>element_rect()</code></td>
</tr>
<tr>
<td>符号</td>
<td><code>legend.key</code></td>
<td><code>element_rect()</code></td>
</tr>
<tr>
<td>标签</td>
<td><code>legend.text</code></td>
<td><code>element_text()</code></td>
</tr>
<tr>
<td>标题</td>
<td><code>legend.title</code></td>
<td><code>element_text()</code></td>
</tr>
<tr>
<td>边距</td>
<td><code>legend.margin</code></td>
<td><code>margin()</code></td>
</tr>
<tr>
<td>位置</td>
<td><code>legend.position</code></td>
<td>“top” “bottom” “left” “right”</td>
</tr>
</tbody>
</table>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span></span><br><span class="line">ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span>y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_grid<span class="punctuation">(</span>vars<span class="punctuation">(</span>manufacturer<span class="punctuation">)</span><span class="punctuation">,</span> vars<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">ggtitle<span class="punctuation">(</span><span class="string">&quot;这是我的标题&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x_displ&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;y_hwy&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;grey80&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.position <span class="operator">=</span> <span class="string">&quot;top&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261923599.png" alt></p>
<h3 id="分面元素"><a class="markdownIt-Anchor" href="#分面元素"></a> 分面元素</h3>
<table>
<thead>
<tr>
<th>描述</th>
<th>主题元素</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>分面标签背景</td>
<td><code>strip.background</code></td>
<td><code>element_rect()</code></td>
</tr>
<tr>
<td>条状文本</td>
<td><code>strip.text</code></td>
<td><code>element_text()</code></td>
</tr>
<tr>
<td>分面间隔</td>
<td><code>panel.spacing</code></td>
<td>unit</td>
</tr>
</tbody>
</table>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span></span><br><span class="line">ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span>y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_grid<span class="punctuation">(</span>vars<span class="punctuation">(</span>manufacturer<span class="punctuation">)</span><span class="punctuation">,</span> vars<span class="punctuation">(</span><span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">ggtitle<span class="punctuation">(</span><span class="string">&quot;这是我的标题&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x_displ&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;y_hwy&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    strip.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.spacing <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261923530.png" alt></p>
<h2 id="标度"><a class="markdownIt-Anchor" href="#标度"></a> 标度</h2>
<p><strong>映射</strong>是数据转化到图形属性，这里的图形属性是指视觉可以感知的东西，比如大小，形状，颜色和位置等，<strong>标度</strong>（<strong>scale</strong>）是控制着数据到图形属性映射的<strong>函数</strong>，每一种标度都是从数据空间的某个区域（标度的定义域）到图形属性空间的某个区域（标度的值域）的一个<strong>函数</strong>。</p>
<p>每一个视觉属性背后都有标度。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;x轴&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261924829.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_x_continuous<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&quot;x轴&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261925369.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261925448.png" alt></p>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261926053.png" alt></p>
<p>标度函数命名规则：</p>
<p>标度函数是由”_“分割的三个部分构成的。</p>
<ul>
<li>
<p>scale</p>
</li>
<li>
<p>视觉属性名（e.g., color, shape or x）</p>
</li>
<li>
<p>标度名（e.g., continuous, discrete, brewer）</p>
</li>
</ul>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261926883.png" alt></p>
<ul>
<li>
<p>参数<code>name</code>，坐标和图例的名字，如果不想要图例的名字，就可以<br>
<code>name = NULL</code></p>
</li>
<li>
<p>参数<code>limits</code>,<br>
坐标或图例的范围区间。连续性<code>c(n, m)</code>，离散型<code>c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</code></p>
</li>
<li>
<p>参数<code>breaks</code>, 控制显示在坐标轴或者图例上的值（元素）</p>
</li>
<li>
<p>参数<code>labels</code>, 坐标和图例的间隔标签</p>
<ul>
<li>一般情况下，内置函数会自动完成</li>
<li>也可人工指定一个字符型向量，与<code>breaks</code>提供的字符型向量一一对应</li>
<li>也可以是函数，把<code>breaks</code>提供的字符型向量当做函数的输入</li>
<li><code>NULL</code>，就是去掉标签</li>
</ul>
</li>
<li>
<p>参数<code>values</code> 指的是（颜色、形状等）视觉属性值,</p>
<ul>
<li>要么，与数值的顺序一致；</li>
<li>要么，与<code>breaks</code>提供的字符型向量长度一致</li>
<li>要么，用命名向量<code>c(&quot;数据标签&quot; = &quot;视觉属性&quot;)</code>提供</li>
</ul>
</li>
<li>
<p>参数<code>expand</code>, 控制参数溢出量</p>
</li>
<li>
<p>参数<code>range</code>, 设置尺寸大小范围，比如针对点的相对大小</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gapdata <span class="operator">&lt;-</span> read_csv<span class="punctuation">(</span><span class="string">&quot;data/gapminder.csv&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">&lt;-</span> gapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>continent<span class="punctuation">,</span> country<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  summarise<span class="punctuation">(</span></span><br><span class="line">    across<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>lifeExp<span class="punctuation">,</span> gdpPercap<span class="punctuation">,</span> pop<span class="punctuation">)</span><span class="punctuation">,</span> mean<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line">newgapdata</span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 142 × 5
#&gt; # Groups:   continent [5]
#&gt;    continent country                  lifeExp gdpPercap       pop
#&gt;    &lt;chr&gt;     &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt;  1 Africa    Algeria                     59.0     4426. 19875406.
#&gt;  2 Africa    Angola                      37.9     3607.  7309390.
#&gt;  3 Africa    Benin                       48.8     1155.  4017497.
#&gt;  4 Africa    Botswana                    54.6     5032.   971186.
#&gt;  5 Africa    Burkina Faso                44.7      844.  7548677.
#&gt;  6 Africa    Burundi                     44.8      472.  4651608.
#&gt;  7 Africa    Cameroon                    48.1     1775.  9816648.
#&gt;  8 Africa    Central African Republic    43.9      959.  2560963 
#&gt;  9 Africa    Chad                        46.8     1165.  5329256.
#&gt; 10 Africa    Comoros                     52.4     1314.   361684.
#&gt; # ℹ 132 more rows
</code></pre>
<h3 id="坐标轴"><a class="markdownIt-Anchor" href="#坐标轴"></a> 坐标轴</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> continent<span class="punctuation">,</span> size <span class="operator">=</span> pop<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_continuous<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261927264.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> continent<span class="punctuation">,</span> size <span class="operator">=</span> pop<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_log10<span class="punctuation">(</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261928986.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> continent<span class="punctuation">,</span> size <span class="operator">=</span> pop<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_log10<span class="punctuation">(</span></span><br><span class="line">      name <span class="operator">=</span> <span class="string">&quot;GDP per capita&quot;</span><span class="punctuation">,</span></span><br><span class="line">      breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">500</span><span class="punctuation">,</span> <span class="number">1000</span><span class="punctuation">,</span> <span class="number">3000</span><span class="punctuation">,</span> <span class="number">10000</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      labels <span class="operator">=</span> scales<span class="operator">::</span>unit_format<span class="punctuation">(</span>unit <span class="operator">=</span> <span class="string">&quot;dollar&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261928876.png" alt></p>
<h3 id="颜色"><a class="markdownIt-Anchor" href="#颜色"></a> 颜色</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> continent<span class="punctuation">,</span> size <span class="operator">=</span> pop<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_log10<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_color_viridis_d<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261929606.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> continent<span class="punctuation">,</span> size <span class="operator">=</span> pop<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_log10<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_color_brewer<span class="punctuation">(</span>type <span class="operator">=</span> <span class="string">&quot;qual&quot;</span><span class="punctuation">,</span> palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261929736.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">newgapdata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> gdpPercap<span class="punctuation">,</span> y <span class="operator">=</span> lifeExp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> continent<span class="punctuation">,</span> size <span class="operator">=</span> pop<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_log10<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_color_manual<span class="punctuation">(</span></span><br><span class="line">      name <span class="operator">=</span> <span class="string">&quot;continents&quot;</span><span class="punctuation">,</span></span><br><span class="line">      values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Africa&quot;</span> <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Americas&quot;</span> <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Asia&quot;</span> <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span></span><br><span class="line">                 <span class="string">&quot;Europe&quot;</span> <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Oceania&quot;</span> <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Africa&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Americas&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Asia&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Europe&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Oceania&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;africa&quot;</span><span class="punctuation">,</span> <span class="string">&quot;americas&quot;</span><span class="punctuation">,</span> <span class="string">&quot;asia&quot;</span><span class="punctuation">,</span> <span class="string">&quot;europe&quot;</span><span class="punctuation">,</span> <span class="string">&quot;oceania&quot;</span><span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   scale_size<span class="punctuation">(</span></span><br><span class="line">     name <span class="operator">=</span> <span class="string">&quot;population size&quot;</span><span class="punctuation">,</span></span><br><span class="line">     breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2e8</span><span class="punctuation">,</span> <span class="number">5e8</span><span class="punctuation">,</span> <span class="number">7e8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">     labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;200 million&quot;</span><span class="punctuation">,</span> <span class="string">&quot;500 million&quot;</span><span class="punctuation">,</span> <span class="string">&quot;700 million&quot;</span><span class="punctuation">)</span></span><br><span class="line">   <span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261929446.png" alt></p>
<p>用标度还是主题？</p>
<p>那什么时候用标度，什么时候用主题？这里有个原则：主题风格不会增加标签，也不会改变变量的范围，主题只会改变字体、大小、颜色等等。</p>
<h2 id="教程一"><a class="markdownIt-Anchor" href="#教程一"></a> 教程（一）</h2>
<p>加载包</p>
<p>加载数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">haven<span class="operator">::</span>read_dta<span class="punctuation">(</span><span class="string">&quot;data/auto.dta&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> auto</span><br><span class="line">auto</span><br></pre></td></tr></table></figure>
<pre><code>#&gt; # A tibble: 74 × 12
#&gt;    make        price   mpg rep78 headroom trunk weight length  turn displacement
#&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
#&gt;  1 AMC Concord  4099    22     3      2.5    11   2930    186    40          121
#&gt;  2 AMC Pacer    4749    17     3      3      11   3350    173    40          258
#&gt;  3 AMC Spirit   3799    22    NA      3      12   2640    168    35          121
#&gt;  4 Buick Cent…  4816    20     3      4.5    16   3250    196    40          196
#&gt;  5 Buick Elec…  7827    15     4      4      20   4080    222    43          350
#&gt;  6 Buick LeSa…  5788    18     3      4      21   3670    218    43          231
#&gt;  7 Buick Opel   4453    26    NA      3      10   2230    170    34          304
#&gt;  8 Buick Regal  5189    20     3      2      16   3280    200    42          196
#&gt;  9 Buick Rivi… 10372    16     3      3.5    17   3880    207    43          231
#&gt; 10 Buick Skyl…  4082    19     3      3.5    13   3400    200    42          231
#&gt; # ℹ 64 more rows
#&gt; # ℹ 2 more variables: gear_ratio &lt;dbl&gt;, foreign &lt;dbl+lbl&gt;
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">attributes</span><span class="punctuation">(</span>auto<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<pre><code>#&gt; $class
#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
#&gt; 
#&gt; $row.names
#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
#&gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
#&gt; [51] 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74
#&gt; 
#&gt; $label
#&gt; [1] &quot;1978 Automobile Data&quot;
#&gt; 
#&gt; $notes
#&gt; [1] &quot;1&quot;                                    
#&gt; [2] &quot;from Consumer Reports with permission&quot;
#&gt; 
#&gt; $names
#&gt;  [1] &quot;make&quot;         &quot;price&quot;        &quot;mpg&quot;          &quot;rep78&quot;        &quot;headroom&quot;    
#&gt;  [6] &quot;trunk&quot;        &quot;weight&quot;       &quot;length&quot;       &quot;turn&quot;         &quot;displacement&quot;
#&gt; [11] &quot;gear_ratio&quot;   &quot;foreign&quot;
</code></pre>
<p>创建ggplot2图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> auto<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261930664.png" alt></p>
<p>美学映射</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> auto<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">,</span> size <span class="operator">=</span> rep78<span class="punctuation">,</span> color <span class="operator">=</span> rep78<span class="punctuation">,</span> alpha <span class="operator">=</span> rep78<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment">#点的大小、颜色、透明度建立映射 </span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261930516.png" alt></p>
<p>rep为离散型变量，但是上图中的色彩映射，默认为连续型变量，将rep78设置为因子型变量，图例显示为离散型。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> auto<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">,</span> size <span class="operator">=</span> rep78<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> rep78<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261931872.png" alt></p>
<p>将图例合并到一起，要解决两个问题：</p>
<ul>
<li>
<p>分类要一致</p>
</li>
<li>
<p>图例名字要统一</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> auto <span class="operator">%&gt;%</span> </span><br><span class="line">         subset<span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">,</span> size <span class="operator">=</span> rep78<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> rep78<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;rep78&quot;</span><span class="punctuation">)</span> <span class="comment">#修改轴、图例和plot的标签</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261931212.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> auto <span class="operator">%&gt;%</span> </span><br><span class="line">         subset<span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">,</span> size <span class="operator">=</span> rep78<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> rep78<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&quot;rep78&quot;</span><span class="punctuation">)</span> <span class="comment">#利用标度修改图例标题</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261932217.png" alt></p>
<p>size的内容在aes()里为映射，在aes()外为设置</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> auto <span class="operator">%&gt;%</span> </span><br><span class="line">         subset<span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">,</span> color <span class="operator">=</span> factor<span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261932191.png" alt></p>
<p><code>strok()</code>代表环的宽度</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> subset<span class="punctuation">(</span>auto<span class="punctuation">,</span> <span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> weight<span class="punctuation">,</span> y <span class="operator">=</span> price<span class="punctuation">,</span> stroke <span class="operator">=</span> rep78<span class="punctuation">)</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261932851.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">haven<span class="operator">::</span>read_dta<span class="punctuation">(</span><span class="string">&quot;data/world-covid19.dta&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df</span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>date<span class="punctuation">,</span> confirmed<span class="punctuation">,</span> group <span class="operator">=</span> country<span class="punctuation">)</span><span class="punctuation">)</span>  </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261933411.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>date<span class="punctuation">,</span> confirmed<span class="punctuation">,</span> color <span class="operator">=</span> country<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261933924.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在theme中修改图例位置为none，去掉图例</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="operator">:</span><span class="number">5</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  crossing<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  set_names<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;x&quot;</span><span class="punctuation">,</span> <span class="string">&quot;y&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  mutate<span class="punctuation">(</span>z <span class="operator">=</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>row.names<span class="punctuation">(</span>.<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> shape <span class="operator">=</span> I<span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;green&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> z<span class="punctuation">,</span> y <span class="operator">=</span> y <span class="operator">+</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261934468.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># I(z)使得z变量直接用作点的形状，而不是尝试在aes()内部解释它。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">auto <span class="operator">%&gt;%</span> </span><br><span class="line">  count<span class="punctuation">(</span>rep78<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> rep78<span class="punctuation">,</span> y <span class="operator">=</span> n<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggchicklet<span class="operator">::</span>geom_chicklet<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261934419.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 圆角柱状图</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df <span class="operator">%&gt;%</span> </span><br><span class="line">  filter<span class="punctuation">(</span>country <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;中国&quot;</span><span class="punctuation">,</span> <span class="string">&quot;美国&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> confirmed<span class="punctuation">,</span> color <span class="operator">=</span> country<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261934700.png" alt></p>
<p>位置调整</p>
<p>常见的柱状图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>auto<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_bar<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> rep78<span class="punctuation">,</span>   fill <span class="operator">=</span> factor<span class="punctuation">(</span>rep78<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261935573.png" alt></p>
<p><code>geom_col()</code>是没有统计变换的<code>geom_bar()</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>auto<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_bar<span class="punctuation">(</span></span><br><span class="line">    aes<span class="punctuation">(</span></span><br><span class="line">      x <span class="operator">=</span> rep78<span class="punctuation">,</span> </span><br><span class="line">      color <span class="operator">=</span> factor<span class="punctuation">(</span>foreign<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">      fill <span class="operator">=</span> factor<span class="punctuation">(</span>foreign<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      position <span class="operator">=</span> position_identity<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span>  <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261936260.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>auto<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_bar<span class="punctuation">(</span></span><br><span class="line">    aes<span class="punctuation">(</span></span><br><span class="line">      x <span class="operator">=</span> rep78<span class="punctuation">,</span> </span><br><span class="line">      color <span class="operator">=</span> factor<span class="punctuation">(</span>foreign<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">      fill <span class="operator">=</span> factor<span class="punctuation">(</span>foreign<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      position <span class="operator">=</span> position_dodge<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span>  <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261936622.png" alt></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>auto<span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_bar<span class="punctuation">(</span></span><br><span class="line">    aes<span class="punctuation">(</span></span><br><span class="line">      x <span class="operator">=</span> rep78<span class="punctuation">,</span> </span><br><span class="line">      color <span class="operator">=</span> factor<span class="punctuation">(</span>foreign<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">      fill <span class="operator">=</span> factor<span class="punctuation">(</span>foreign<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      position <span class="operator">=</span> position_fill<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    legend.position <span class="operator">=</span>  <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="string">&quot;foreign&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261937879.png" alt></p>
<p>坐标系</p>
<p><code>coord_flip()</code></p>
<p><code>coord_fixed</code></p>
<p><code>coord_sf()</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>sf<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">read_sf<span class="punctuation">(</span><span class="string">&quot;data/world_high_resolution_mill.geo.json&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> wdmp</span><br><span class="line">haven<span class="operator">::</span>read_dta<span class="punctuation">(</span><span class="string">&quot;data/world-covid19.dta&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> df</span><br><span class="line"></span><br><span class="line">wdmp <span class="operator">%&gt;%</span> </span><br><span class="line">  left_join<span class="punctuation">(</span>df<span class="punctuation">,</span> by <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;code&quot;</span> <span class="operator">=</span> <span class="string">&quot;iso&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  subset<span class="punctuation">(</span>date <span class="operator">==</span> <span class="string">&quot;2020-06-10&quot;</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> mydata</span><br><span class="line">mydata</span><br></pre></td></tr></table></figure>
<pre><code>#&gt; Simple feature collection with 180 features and 9 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -20015110 ymin: -6947577 xmax: 20015110 ymax: 12641180
#&gt; Projected CRS: World_Miller_Cylindrical
#&gt; # A tibble: 180 × 10
#&gt;    name    name_en code                   geometry country country_en date      
#&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;MULTIPOLYGON [m]&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;date&gt;    
#&gt;  1 阿尔及… ALGERIA DZA   (((-245324.1 4068138, -2… 阿尔及… Algeria    2020-06-10
#&gt;  2 列支敦… Liecht… LIE   (((1067880 5656162, 1059… 列支敦… Liechtens… 2020-06-10
#&gt;  3 埃及    EGYPT   EGY   (((3961141 2619833, 3915… 埃及    Egypt      2020-06-10
#&gt;  4 孟加拉… BANGLA… BGD   (((10297641 2482880, 102… 孟加拉… Bangladesh 2020-06-10
#&gt;  5 尼日尔  Niger   NER   (((400866.4 1306467, 394… 尼日尔  Niger      2020-06-10
#&gt;  6 卡塔尔  QATAR   QAT   (((5699872 2791895, 5682… 卡塔尔  Qatar      2020-06-10
#&gt;  7 纳米比… NAMIBIA NAM   (((2223927 -2808902, 222… 纳米比… Namibia    2020-06-10
#&gt;  8 保加利… Bulgar… BGR   (((2486312 5005203, 2497… 保加利… Bulgaria   2020-06-10
#&gt;  9 玻利维… Bolivia BOL   (((-6966045 -2514366, -6… 玻利维… Bolivia    2020-06-10
#&gt; 10 加纳    Ghana   GHA   (((-299106.5 1058207, -3… 加纳    Ghana      2020-06-10
#&gt; # ℹ 170 more rows
#&gt; # ℹ 3 more variables: confirmed &lt;dbl&gt;, recovered &lt;dbl&gt;, deaths &lt;dbl&gt;
</code></pre>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mydata <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_sf<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> confirmed<span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.01</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_sf<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  guides<span class="punctuation">(</span>fill <span class="operator">=</span> guide_legend<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    panel.grid.major <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span></span><br><span class="line">    fill <span class="operator">=</span> <span class="string">&quot;确诊人数&quot;</span><span class="punctuation">,</span></span><br><span class="line">    title <span class="operator">=</span> <span class="string">&quot;全球新馆疫情：2020-06-10&quot;</span><span class="punctuation">,</span></span><br><span class="line">    caption <span class="operator">=</span> <span class="string">&quot;数据来源&quot;</span></span><br><span class="line">    <span class="punctuation">)</span> </span><br></pre></td></tr></table></figure>
<p><img data-src="https://scy11.oss-cn-beijing.aliyuncs.com/img/202309261937033.png" alt></p>

        </div>

        
        
        

        <div>
            
            <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------<i class="fa fa-paw"></i>已经到底啦<i class="fa fa-paw"></i>-------------</div>
    
</div>

            
        </div>

        <footer class="post-footer">
            <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="SCY 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="SCY 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

            <div class="post-tags">
                <a href="/tags/R/" rel="tag"><i class="fa fa-tag"></i> R</a>
                <a href="/tags/ggplot2/" rel="tag"><i class="fa fa-tag"></i> ggplot2</a>
            </div>

            
  <div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" target="_blank" rel="external nofollow noopener noreferrer" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_facebook"></a>
      <a class="a2a_button_twitter"></a>
  </div>

            <div class="post-nav">
                <div class="post-nav-item">
                    <a href="/2023/09/24/2023-9-24-17%E6%A0%85%E6%A0%BC%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8A%80%E5%B7%A7/" rel="prev" title="(17)栅格数据处理技巧">
                        <i class="fa fa-angle-left"></i> (17)栅格数据处理技巧
                    </a>
                </div>
                <div class="post-nav-item">
                    <a href="/2023/09/26/2023-9-26-19%E5%9C%B0%E5%9B%BE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="next" title="(19)地图可视化">
                        (19)地图可视化 <i class="fa fa-angle-right"></i>
                    </a>
                </div>
            </div>
        </footer>
    </article>
</div>






    <div class="comments" id="waline"></div>
</div>
    </main>
    <footer class="footer">
      <div class="footer-inner">

<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">178k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">10:47</span>
  </span>
</div>
<div class="busuanzi-count">
</div>

<!-- 删除 “由 Hexo & NexT.Gemini 强力驱动” -->
<!-- -->

      </div>
    </footer>
    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

    
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.20/fancybox/fancybox.umd.js" integrity="sha256-q8XkJ6dj5VwSvzI8+nATCHHQG+Xv/dAZBCgqmu93zOY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.19.1/algoliasearch-lite.umd.js" integrity="sha256-qzlNbRtZWHoUV5I2mI2t9QR7oYXlS9oNctX+0pECXI0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.56.8/instantsearch.production.min.js" integrity="sha256-xUys6KCuRGBxFaRaYZlWulRUjY48XFv6/Q2s0mb1dmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/algolia-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{"enable":true,"async":true,"id":null}</script>
<script src="/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js","integrity":"sha256-9y71g5Lz/KLsHjB8uXwnkuWDtAMDSzD/HdIbqhJfTAI="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script class="next-config" data-name="wavedrom" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.3.0/wavedrom.min.js","integrity":"sha256-IRMDzTC+wK5stMucZ/XSXkeS5VNtxZ+/Bm8Mcqfoxdo="}}</script>
  <script class="next-config" data-name="wavedrom_skin" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.3.0/skins/default.js","integrity":"sha256-fduc/Zszk5ezWws2uInY/ALWVmIrmV6VTgXbsYSReFI="}}</script>
  <script src="/js/third-party/tags/wavedrom.js"></script>

  <script src="/js/third-party/fancybox.js"></script>


  <script src="/js/third-party/addtoany.js"></script>

    
  <script data-pjax async src="/js/busuanzi.js"></script>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://ancao96.github.io/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}</script>
  <script src="/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://waline-server-nxpj3ksyo-scy.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"请文明评论呀~","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":true,"comment_count":true,"requiredFields":["nick","mail"],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","eemoji":["https://unpkg.com/@waline/emojis@1.1.0/tw-emoji","//unpkg.com/@waline/emojis@1.1.0/bilibili","//unpkg.com/@waline/emojis@1.1.0/alus","https://unpkg.com/@waline/emojis@1.1.0/weibo"],"el":"#waline","comment":true,"path":"/2023/09/26/2023-9-26-18ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

    <link rel="stylesheet" href="/dist/APlayer.min.css">
    <div id="aplayer"></div>
    <script type="text/javascript" src="/dist/APlayer.min.js"></script>
    <script type="text/javascript" src="/dist/music.js"></script>
    
  </body>
</html>
